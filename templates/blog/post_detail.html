{% extends "base.html" %} {% block title %}글 내용{% endblock title %} <br />
{%block content %} {% load markdown_deux_tags %}{% load static %}
<div
  class="flex min-h-full flex-col justify-center align-center px-6 sm:mx-auto sm:w-full sm:max-w-3xl"
>
  <div class="title-menu flex justify-between">
    <p class="text-4xl font-bold">{{ object.title }}</p>
    {% if post.author.username == request.user or request.user.is_superuser %}
  <div class="actions flex flex-row">
    <a href="{% url "blog:post_update" post.pk %}" class="justify:flex-end sm:ml-6 bg-green-800 text-gray-300 hover:bg-green-500 hover:text-white rounded-md px-3  pt-1 my-1 text-sm font-medium">글 수정</a>
    <a href="#" class="flex-end sm:ml-6 bg-red-600 text-gray-300 hover:bg-red-400 hover:text-white rounded-md px-3  pt-1 my-1 text-sm font-medium" id="delete-post-button">글 삭제</a>
  </div>
    {% endif %}
  </div>
    <div class="post_footer pt-2 pr-2 pb-1 h-10 flex flex-row justify-between">
    <a class="profile flex flex-row" href="{% url 'blog:post_user' post.author.username %}">
      <img class="h-7 w-7 rounded-full" src="{% if post.author.profile_img %}{{ post.author.profile_img.url }}{% else %}{% static 'profile-default.jpg' %}{% endif %}" />
      <span class="pl-2 pt-2 text-[12px] text-[#757575]">by <b>
          {% if post.author.nickname %}{{post.author.nickname }}{% else %}{{ post.author.username }}{% endif %}</b></span>
  </a>
  {% if post.updated_at %}
  <span class="post_date text-[12px] text-gray-500">{{ post.updated_at }}</span>
  {% else %}
  <span class="post_date text-[12px]">{{ post.created_at }}</span>
  {% endif %}
</div>
{% if object.file_upload %}
<p>첨부파일: {{ object.file_upload.name }}({{ object.file_upload.size }}B) <a href="{{ object.file_upload.url }}" target="_blank">다운로드</a></p>
{% else %}{% endif %}
  {% if object.thumbnail %}
    <img class="w-fit mx-auto mt-4" src="{{ object.thumbnail.url }}"></img>
  {% else %}{% endif %}

  <div class="post-content xl:w-full leading-relaxed">
      {{ object.content|markdown }}
    </div>
    
    
    
    <h2 class="text-3xl">댓글</h2>
    
    {% for comment in comments reversed %}
  <div>
    {% if not comment.recomment %}
      <div>댓글: {{ comment.comment }}</div>
      {% endif %}
      {% if comment.recomment %}
      
      <div>대댓글: {{ comment.comment }}</div>
    {% endif %}
    {% if not comment.recomment %}
      <form method="post" action="{% url 'blog:post_detail' post.pk %}">
        {% csrf_token %}
        {{ comment_form.as_p }}
        <input type="hidden" name="recomment" value="{{ comment.id }}">
        <button type="submit">대댓글 작성</button>
      </form>
      {% endif %}
  </div>
{% endfor %}
<h3>새 댓글 작성</h3>
<form method="post" action="{% url 'blog:post_detail' post.pk %}">
  {% csrf_token %}
  {{ comment_form.as_p }}
  <button type="submit">댓글 작성</button>
</form>
  </div>
</div>


{% endblock content %} {% block scripts %}
<script>
  const h1s = document.querySelectorAll(".post-content h1");
  const h2s = document.querySelectorAll(".post-content h2");
  const h3s = document.querySelectorAll(".post-content h3");
  const h4s = document.querySelectorAll(".post-content h4");
  const h5s = document.querySelectorAll(".post-content h5");
  const ols = document.querySelectorAll(".post-content ol");
  const ps = document.querySelectorAll(".post-content p");
  const imgs = document.querySelectorAll(".post-content img");

  h1s.forEach((h1) => {
    h1.classList.add("text-5xl");
    h1.classList.add("font-bold");
    h1.classList.add("mt-4");
  });
  h2s.forEach((h2) => {
    h2.classList.add("text-4xl");
    h2.classList.add("font-bold");
    h2.classList.add("mt-4");
  });
  h3s.forEach((h3) => {
    h3.classList.add("text-3xl");
    h3.classList.add("font-bold");
    h3.classList.add("mt-4");
  });
  h4s.forEach((h4) => {
    h4.classList.add("text-2xl");
    h4.classList.add("font-bold");
    h4.classList.add("mt-4");
  });
  h5s.forEach((h5) => {
    h5.classList.add("text-xl");
    h5.classList.add("font-bold");
    h5.classList.add("mt-4");
  });
  ols.forEach((ol) => {
    ol.classList.add("list-decimal");
    ol.classList.add("list-inside");
  });
  ps.forEach((p) => {
    p.classList.add("mt-4");
  });
  imgs.forEach((img) => {
    img.classList.add("w-fit");
    img.classList.add("mx-auto");
    img.classList.add("mt-4");
  });

  document.getElementById("delete-post-button").addEventListener("click", function() {
    if (confirm("글을 삭제하시겠습니까?")) {
        window.location.href = "{% url 'blog:post_delete' post.pk %}";
    }
});
</script>
{% endblock scripts %}
